{% extends "base.html" %} {% block title %}{{ title }}{% endblock %} {% block
content %}
<div class="page-main admin-view">
  <div class="admin-header">
    <h2>Proveedores Registrados</h2>
    <div style="position: relative">
      <input
        type="text"
        id="adminSearch"
        placeholder="Buscar..."
        class="styled-input"
        style="padding-left: 2.5rem; width: 300px"
      />
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="18"
        height="18"
        viewBox="0 0 24 24"
        F
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        style="
          position: absolute;
          left: 1rem;
          top: 50%;
          transform: translateY(-50%);
          color: var(--Color7);
          pointer-events: none;
        "
      >
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </div>
  </div>

  <div class="admin-table-container">
    <table class="admin-table">
      <thead>
        <tr>
          <th>Usuario</th>
          <th>Correo</th>
          <th>Nombre</th>
          <th>NIT</th>
          <th>Ciudad</th>
          <th>Tipo</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for p in providers %}
        <tr>
          <!-- Username as Link to Profile -->
          <td>
            <a href="/profile/{{ p.usuario.username }}" class="link-primary">
              {{ p.usuario.username }}
            </a>
          </td>
          <td>{{ p.usuario.correo }}</td>
          <td>{{ p.nombres_apellidos }}</td>
          <td>{{ p.identificacion_nit }}</td>
          <td>{{ p.ciudad }}</td>
          <td>{{ p.tipo_proveedor }}</td>
          <td>
            <!-- Delete Button -->
            <form
              action="/admin/delete_user"
              method="post"
              onsubmit="return confirm('Â¿Seguro que quieres eliminar a este usuario?');"
              style="margin: 0"
            >
              <input
                type="hidden"
                name="username"
                value="{{ p.usuario.username }}"
              />
              <button type="submit" class="btn-delete">Eliminar</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="7" style="text-align: center">
            No hay proveedores registrados.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<script>
  document.getElementById("adminSearch").addEventListener("keyup", function () {
    const searchValue = this.value.toLowerCase();
    const rows = document.querySelectorAll(".admin-table tbody tr");

    rows.forEach((row) => {
      // Logic for "No data" row
      if (row.cells.length === 1 && row.cells[0].colSpan > 1) return;

      const cells = Array.from(row.cells);
      // Exclude action column from search if desired, here we search all text
      const matches = cells.some((cell) =>
        cell.textContent.toLowerCase().includes(searchValue)
      );

      row.style.display = matches ? "" : "none";
    });
  });
</script>
{% endblock %}
